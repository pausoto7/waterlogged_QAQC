% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/adjust_wl_zero.R
\name{adjust_WL_zero}
\alias{adjust_WL_zero}
\title{Adjust water level zero/reference}
\usage{
adjust_WL_zero(
  input_data,
  select_station,
  change_value = NULL,
  timestamp_start = NULL,
  timestamp_end = NULL,
  manual_note,
  log_root,
  user = Sys.info()[["user"]]
)
}
\arguments{
\item{input_data}{Data frame containing water level data for one or more
stations. Must include \code{timestamp}, \code{site_station_code}, \code{waterlevel_m},
and \code{waterlevel_m_adj}.}

\item{select_station}{Character; station code to adjust
(value of \code{site_station_code}).}

\item{change_value}{Numeric offset (m) to add to \code{waterlevel_m_adj}.
Positive values shift levels up, negative values shift them down. If
\code{NULL}, the offset is computed from the average water level between
\code{timestamp_start} and \code{timestamp_end}.}

\item{timestamp_start}{Start of window used to compute automatic zero
(character \code{"YYYY-MM-DD HH:MM:SS"}, typically UTC), only used if
\code{change_value} is \code{NULL}.}

\item{timestamp_end}{End of window used to compute automatic zero
(character \code{"YYYY-MM-DD HH:MM:SS"}, typically UTC), only used if
\code{change_value} is \code{NULL}.}

\item{manual_note}{Character, required. Description of why the zero shift
was applied (stored in the QA/QC log).}

\item{log_root}{Root folder used to build the QA/QC log path (passed to
\code{qaqc_log_path()}).}

\item{user}{Username written to the QA/QC log. Defaults to
\code{Sys.info()[["user"]]}.}
}
\value{
Modified data frame for \code{select_station} with updated
\code{waterlevel_m_adj} and \code{edit_zero} flag, and a QA/QC log entry written
to disk.
}
\description{
Shift adjusted water levels by a constant offset to change the zero/reference
level. If \code{change_value} is \code{NULL}, the offset is computed from the mean
water level in a specified time window (assumed to represent the new zero).
}
\details{
If \code{change_value} is supplied, that constant is added to the entire
\code{waterlevel_m_adj} series.

If \code{change_value} is \code{NULL}, the function:
\itemize{
\item Filters rows between \code{timestamp_start} and \code{timestamp_end}.
\item Computes the mean of \code{waterlevel_m_adj} in that window, if present;
otherwise falls back to \code{waterlevel_m}.
\item Uses the negative of this mean as the offset, so that the mean level
in that window becomes approximately 0 m.
\item Applies this offset to all \code{waterlevel_m_adj} values.
}
In both cases, \code{edit_zero} is set to \code{TRUE} for all rows for which the
adjusted series was shifted.
}
\seealso{
\code{\link[=adjust_WL_offset]{adjust_WL_offset()}}, \code{\link[=adjust_waterlevel_spike]{adjust_waterlevel_spike()}},
\code{\link[=adjust_logger_NA]{adjust_logger_NA()}}, \code{\link[=make_qaqc_log_row]{make_qaqc_log_row()}}, \code{\link[=qaqc_log_path]{qaqc_log_path()}},
\code{\link[=qaqc_log_append]{qaqc_log_append()}}
}
