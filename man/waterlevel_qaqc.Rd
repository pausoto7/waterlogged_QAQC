% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/waterlevel_qaqc.R
\name{waterlevel_qaqc}
\alias{waterlevel_qaqc}
\title{Automatic QA/QC for water level and water temperature data}
\usage{
waterlevel_qaqc(
  input_data,
  select_station,
  log_root,
  user = Sys.info()[["user"]]
)
}
\arguments{
\item{input_data}{Data frame containing water level logger data with columns:
\code{site_station_code}, \code{timestamp}, \code{waterlevel_m}, \code{watertemp_C},
\code{waterpress_kPa}, \code{airpress_kPa}, and \code{airtemp_C}. Typically the output
from \code{\link[=convert_waterlevel_kPa_m]{convert_waterlevel_kPa_m()}}.}

\item{select_station}{Character; the station code to process (must match
a value in \code{site_station_code} column).}

\item{log_root}{Character; root directory where QA/QC logs will be written.
Log files are created at \verb{<log_root>/logs/<station>_<metric>_QAQC_log.csv}.}

\item{user}{Character; username to record in the QA/QC log. Defaults to
\code{Sys.info()[["user"]]}.}
}
\value{
A data frame containing the input data for \code{select_station} with
additional adjusted columns (\verb{*_adj}) and flag columns. Rows are sorted
by timestamp. QA/QC log entries are written to disk as a side effect.
}
\description{
Applies automated quality assurance and quality control rules to water level
and water temperature time series data. Detects and flags potential issues
including sensor disturbances, dry conditions, ice presence, and invalid
temperature readings. All QA/QC actions are logged for traceability.
}
\details{
The function applies the following QA/QC rules:

\strong{Water Temperature Rules:}
\itemize{
\item Temperatures < -1\u00B0C are set to NA (invalid readings)
\item Temperatures between -1\u00B0C and 0\u00B0C are corrected to 0\u00B0C
\item Temperatures < 0.3\u00B0C are flagged as potential ice conditions
}

\strong{Water Level Rules:}
\itemize{
\item Step changes > 0.1 m between consecutive readings flagged as disturbance
\item Dry sensor detection based on:
\itemize{
\item Water temperature > 19\u00B0C
\item Water pressure <= air pressure
\item Water-air temperature difference < 2\u00B0C
\item Air temperature warmer than water temperature
}
}

Creates adjusted columns \code{waterlevel_m_adj} and \code{watertemp_C_adj} along with
flag columns: \code{flag_disturbance}, \code{flag_ice}, \code{flag_wl_dry}, \code{neg_lt_minus1},
and \code{neg_between}.
}
\seealso{
\code{\link[=convert_waterlevel_kPa_m]{convert_waterlevel_kPa_m()}}, \code{\link[=qaqc_log_append]{qaqc_log_append()}}, \code{\link[=plot_qaqc_timeseries]{plot_qaqc_timeseries()}}
}
