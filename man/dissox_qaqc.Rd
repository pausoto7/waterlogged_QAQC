% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/dissox_qaqc.R
\name{dissox_qaqc}
\alias{dissox_qaqc}
\title{Automatic QA/QC for dissolved oxygen data}
\usage{
dissox_qaqc(input_data, select_station, log_root, user = Sys.info()[["user"]])
}
\arguments{
\item{input_data}{Data frame containing dissolved oxygen logger data with
columns: \code{site_station_code}, \code{timestamp}, \code{do_mgl}, \code{do_percsat},
\code{watertemp_C}, and \code{airtemp_C}. Typically the output from
\code{\link[=convert_do_mgl_percsat]{convert_do_mgl_percsat()}}.}

\item{select_station}{Character; the station code to process (must match
a value in \code{site_station_code} column).}

\item{log_root}{Character; root directory where QA/QC logs will be written.
Log files are created at \verb{<log_root>/logs/<station>_<metric>_QAQC_log.csv}.}

\item{user}{Character; username to record in the QA/QC log. Defaults to
\code{Sys.info()[["user"]]}.}
}
\value{
A data frame containing the input data for \code{select_station} with
additional adjusted columns (\verb{*_adj}) and flag columns. Rows are sorted
by timestamp. QA/QC log entries are written to disk as a side effect.
}
\description{
Applies automated quality assurance and quality control rules to dissolved
oxygen (DO) time series data. Detects and removes or corrects logger errors,
invalid DO concentrations, negative values, ice conditions, and dry sensor
periods. All QA/QC actions are logged for traceability.
}
\details{
The function applies the following QA/QC rules:

\strong{Dissolved Oxygen Rules:}
\itemize{
\item Logger error codes (-888.88) are removed (set to NA)
\item DO values < -1 mg/L are removed (set to NA)
\item DO values between -1 and 0 mg/L are corrected to 0
\item DO values > 21 mg/L are removed as outliers
\item 12-point dry sensor detection: flags periods where DO percent
saturation >= 100\% and air-water temperature difference <= 2\u00B0C for
12 or more consecutive readings
}

\strong{Water Temperature Rules (DO logger):}
\itemize{
\item Temperatures <= -1\u00B0C are set to NA (invalid readings)
\item Temperatures between -1\u00B0C and 0\u00B0C are corrected to 0\u00B0C
\item Temperatures < 0.3\u00B0C are flagged as potential ice conditions
}

Creates adjusted columns \code{do_mgl_adj}, \code{do_percsat_adj}, and
\code{watertemp_C_do_adj} along with flag columns including \code{flag_do_dry},
\code{temp_flag_ice}, and various error flags.
}
\seealso{
\code{\link[=convert_do_mgl_percsat]{convert_do_mgl_percsat()}}, \code{\link[=qaqc_log_append]{qaqc_log_append()}}, \code{\link[=plot_qaqc_timeseries]{plot_qaqc_timeseries()}}
}
