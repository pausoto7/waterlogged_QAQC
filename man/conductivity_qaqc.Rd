% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/conductivity_qaqc.R, R/conductivity_qaqc_all.R
\name{conductivity_qaqc}
\alias{conductivity_qaqc}
\title{Automatic QA/QC for conductivity data}
\usage{
conductivity_qaqc(
  input_data,
  select_station,
  log_root,
  user = Sys.info()[["user"]],
  temp_low_limit_C = -2,
  temp_high_limit_C = 40,
  disturbance_threshold_uScm = 200,
  dry_threshold_uScm = 10,
  air_water_diff_threshold_C = 2
)

conductivity_qaqc(
  input_data,
  select_station,
  log_root,
  user = Sys.info()[["user"]],
  temp_low_limit_C = -2,
  temp_high_limit_C = 40,
  disturbance_threshold_uScm = 200,
  dry_threshold_uScm = 10,
  air_water_diff_threshold_C = 2
)
}
\arguments{
\item{input_data}{Data frame containing conductivity time series for one or
more stations.}

\item{select_station}{Character station code to filter on
(\code{site_station_code}).}

\item{log_root}{Root directory where QA/QC logs are stored.}

\item{user}{Character user name stored in QA/QC logs.}

\item{temp_low_limit_C}{Minimum acceptable water temperature (\u00B0C) before
being flagged as out of range.}

\item{temp_high_limit_C}{Maximum acceptable water temperature (\u00B0C) before
being flagged as out of range.}

\item{disturbance_threshold_uScm}{Threshold (µS/cm) for detecting
conductivity spikes between consecutive samples.}

\item{dry_threshold_uScm}{Threshold (µS/cm) below which conductivity is
considered “very low” and may indicate dry conditions.}

\item{air_water_diff_threshold_C}{Maximum allowed absolute difference (\u00B0C)
between air and water temperature to support a dry inference when
conductivity is very low.}
}
\value{
A data frame containing the input data for \code{select_station} with
additional adjusted columns (\verb{*_adj}) and flag columns. Rows are sorted
by timestamp. QA/QC log entries are written to disk as a side effect.

The input data filtered to \code{select_station}, with updated
adjusted columns, QA/QC codes, notes, and edit flags. QA/QC events are
also appended to the station log on disk.
}
\description{
Applies automated quality assurance and quality control rules to electrical
conductivity time series data. Detects and flags conductivity spikes, dry
sensor periods (very low conductivity), temperature anomalies, and ice
conditions. All QA/QC actions are logged for traceability.

Performs automatic QA/QC on conductivity logger data for a single station.
The function:
\itemize{
\item Ensures timestamps are in POSIXct (UTC).
\item Creates adjusted columns \code{conduct_uScm_adj} and
\code{watertemp_C_adj} if they do not already exist.
\item Flags and annotates rows with a single QA/QC code in
\code{cond_qaqc_code} and a human-readable explanation in
\code{cond_qaqc_note}.
\item Writes QA/QC log entries to disk using \code{make_qaqc_log_row()},
\code{qaqc_log_path()}, and \code{qaqc_log_append()}.
}
}
\details{
The function applies the following QA/QC rules:

\strong{Conductivity Rules:}
\itemize{
\item Spikes: consecutive readings differing by > 200 µS/cm are flagged
\item Dry detection: conductivity < 10 µS/cm flagged as potential dry sensor
\item Enhanced dry detection: if \code{airtemp_C} is present, dry is also flagged
when conductivity is low AND air-water temperature difference <= 2\u00B0C
}

\strong{Water Temperature Rules:}
\itemize{
\item Temperatures < -2\u00B0C or > 40\u00B0C are flagged as out of range
\item Temperatures < 0.1\u00B0C are flagged as potential ice conditions
\item Temperatures between -1\u00B0C and 0\u00B0C are corrected to 0\u00B0C
}

Creates adjusted columns \code{conduct_uScm_adj} and \code{watertemp_C_adj} along with
flag columns including \code{flag_co_spike}, \code{flag_co_dry}, and \code{flag_co_ice}.

The following automatic rules are applied:
\itemize{
\item Water temperature < \code{temp_low_limit_C} or
> \code{temp_high_limit_C} is considered out of range.
\item Slightly negative water temperatures in [-1, 0) \u00B0C are treated as
sensor noise and corrected to 0 \u00B0C, flagged as \code{"NEGATIVE_WT"}.
\item Water temperature in [0, 0.1) \u00B0C is flagged as \code{"ICE"}.
\item Sudden changes in conductivity > \code{disturbance_threshold_uScm}
between samples are flagged as \code{"SPIKE"}.
\item Very low conductivity (< \code{dry_threshold_uScm} µS/cm) is used
to infer dry conditions, optionally strengthened by air–water
temperature similarity (\code{"DRY_AIRTEMP"} vs
\code{"DRY_COND_ONLY"}).
}

Required columns in \code{input_data} are:
\itemize{
\item \code{timestamp} (POSIXct or character parsable by
\code{lubridate::ymd_hms()}).
\item \code{conduct_uScm} (raw conductivity).
\item \code{watertemp_C} (raw water temperature).
\item \code{airtemp_C} is optional, but improves “dry” detection.
}

If not already present, the function creates:
\itemize{
\item \code{conduct_uScm_adj}, \code{watertemp_C_adj}
\item \code{cond_qaqc_code}, \code{cond_qaqc_note}
\item logical flags \code{edit_cond_spike}, \code{edit_cond_dry},
\code{edit_temp_range}, \code{edit_ice}
}

The original raw data columns are never overwritten; only the \code{*_adj}
columns are modified.
}
\seealso{
\code{\link[=conductivity_qaqc_all]{conductivity_qaqc_all()}}, \code{\link[=conductivity_temp_compensation]{conductivity_temp_compensation()}}, \code{\link[=plot_qaqc_timeseries]{plot_qaqc_timeseries()}}
}
